[
["mlda-regression-disontinuity.html", "7 MLDA Regression Disontinuity 7.1 Refences", " 7 MLDA Regression Disontinuity MLDA Regression Discontinuity (based on data from Carpenter and Dobkin 2009) from Chapter 4 of Mastering Metrics, Table 4.1 and Figures 4.2, 4.4, and 4.5 in Mastering Metrics. These present sharp RD estimates of the effect of the minimum legal drinking age (MLDA) on mortality. Load libraries. library(&quot;tidyverse&quot;) library(&quot;haven&quot;) library(&quot;rlang&quot;) library(&quot;broom&quot;) library(&quot;lmtest&quot;) library(&quot;sandwich&quot;) Load MLDA data data(&quot;mlda&quot;, package = &quot;masteringmetrics&quot;) Add an indicator variable for individuals over 21 years of age. mlda &lt;- mutate(mlda, age = agecell - 21, over21 = as.integer(agecell &gt;= 21)) Add a variable for other causes of death. mlda &lt;- mutate(mlda, ext_oth = external - homicide - suicide - mva) For “all causes”, “motor vehicle accidents”, and “internal causes” deaths plot the linear and quadratic trends on each side of age 21. varlist &lt;- c(&quot;all&quot; = &quot;All Causes&quot;, &quot;mva&quot; = &quot;Motor Vehicle Accidents&quot;, &quot;internal&quot; = &quot;Internal Causes&quot;) mlda %&gt;% select(agecell, over21, one_of(names(varlist))) %&gt;% gather(response, value, -agecell, -over21, na.rm = TRUE) %&gt;% mutate(response = recode(response, !!!as.list(varlist))) %&gt;% ggplot(aes(x = agecell, y = value)) + geom_point() + geom_smooth(mapping = aes(group = over21), se = FALSE, method = &quot;lm&quot;, formula = y ~ poly(x, 2)) + geom_smooth(mapping = aes(group = over21), se = FALSE, method = &quot;lm&quot;, formula = y ~ x, color = &quot;black&quot;) + facet_grid(response ~ ., scales = &quot;free_y&quot;) + labs(y = &quot;Mortality rate (per 100,000)&quot;, x = &quot;Age&quot;) responses &lt;- c(&quot;all&quot; = &quot;All deaths&quot;, &quot;mva&quot; = &quot;Motor vehicle accidents&quot;, &quot;suicide&quot; = &quot;Suicide&quot;, &quot;homicide&quot; = &quot;Homocide&quot;, &quot;ext_oth&quot; = &quot;Other external causes&quot;, &quot;internal&quot; = &quot;All internal causes&quot;, &quot;alcohol&quot; = &quot;Alcohol&quot;) Define a function to run four regressions for a given response variable, y. run_reg &lt;- function(y) { mods &lt;- list( &quot;Ages 19-22, Linear&quot; = lm(quo(!!sym(y) ~ age * over21), data = mlda), &quot;Ages 19-22, Quadratic&quot; = lm(quo(!!sym(y) ~ poly(age, 2, raw = TRUE) * over21), data = mlda), &quot;Ages 20-21, Linear&quot; = lm(quo(!!sym(y) ~ age * over21), data = filter(mlda, agecell &gt;= 20, agecell &lt;= 22)), &quot;Ages 20-21, Quadratic&quot; = lm(quo(!!sym(y) ~ poly(age, 2, raw = TRUE) * over21), data = filter(mlda, agecell &gt;= 20, agecell &lt;= 22)) ) out &lt;- tibble( model_name = names(mods), model = mods, ages = rep(c(&quot;19-22&quot;, &quot;20-21&quot;), each = 2), trend = rep(c(&quot;Linear&quot;, &quot;Quadratic&quot;), 2), model_num = seq_along(mods) ) %&gt;% mutate(coefs = map(model, ~ tidy(coeftest(.x, vcovHC(.x))))) %&gt;% unnest(coefs, .drop = FALSE) %&gt;% filter(term == &quot;over21&quot;) %&gt;% select(model_name, model, term, estimate, std.error) %&gt;% mutate(response = y) # sample size = df.residuals + residuals out[[&quot;obs&quot;]] &lt;- map_dfr(mods, glance) %&gt;% mutate(obs = df.residual + df) %&gt;% pluck(&quot;obs&quot;) out } mlda_regs &lt;- map_dfr(names(responses), run_reg) %&gt;% mutate(response = recode(response, !!!as.list(responses))) mlda_regs %&gt;% select(model_name, response, estimate, std.error) %&gt;% gather(stat, value, estimate, std.error) %&gt;% spread(model_name, value) %&gt;% knitr::kable() response stat Ages 19-22, Linear Ages 19-22, Quadratic Ages 20-21, Linear Ages 20-21, Quadratic Alcohol estimate 0.442 0.799 0.740 1.028 Alcohol std.error 0.213 0.431 0.360 0.725 All deaths estimate 7.663 9.548 9.753 9.611 All deaths std.error 1.374 2.231 2.279 3.565 All internal causes estimate 0.392 1.073 1.692 1.249 All internal causes std.error 0.592 0.931 0.877 1.465 Homocide estimate 0.104 0.200 0.164 -0.453 Homocide std.error 0.394 0.604 0.590 1.594 Motor vehicle accidents estimate 4.534 4.663 4.759 5.892 Motor vehicle accidents std.error 0.731 1.366 1.385 1.937 Other external causes estimate 0.838 1.797 1.414 1.625 Other external causes std.error 0.413 0.673 0.606 1.245 Suicide estimate 1.794 1.814 1.724 1.297 Suicide std.error 0.530 0.950 0.881 1.661 The robuset standard error s using the HC3 standard errors f rom sandwich::vcovHC and dif fer from tho se reported in *Maste ring ’Metrics*. 7.1 Refences http://masteringmetrics.com/wp-content/uploads/2015/01/master_cd_rd.do http://masteringmetrics.com/wp-content/uploads/2015/01/ReadMe_MLDA.txt "]
]
